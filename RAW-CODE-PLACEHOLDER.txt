Here's the clean code, without my comments in spanish:
[PL]
